import{a as V,b as d,c as E,d as G,e as b,f as v,h as I,i as j,j as R,m as H}from"./chunk-64AJHUAZ.js";import{f as T}from"./chunk-LHRA3WSF.js";import{$a as c,Ab as x,Hb as M,Oa as i,Pa as S,S as h,X as y,_ as P,bb as C,fb as m,ia as u,ja as f,jb as r,kb as n,lb as g,ob as _,qb as w,rb as s,xc as N,zb as a}from"./chunk-SVRTX5CE.js";var F=class t{constructor(o){this._HttpClient=o}baseUrl="https://ecommerce.routemisr.com/api/v1/auth/";forgotpassword(o){return this._HttpClient.post(`${this.baseUrl}forgotPasswords`,o)}resetCode(o){return this._HttpClient.post(`${this.baseUrl}verifyResetCode`,o)}resetPassword(o){return this._HttpClient.put(`${this.baseUrl}resetPassword`,o)}static \u0275fac=function(e){return new(e||t)(y(N))};static \u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})};function U(t,o){if(t&1&&(r(0,"p",2),a(1),n()),t&2){let e=s(2);i(),x(e.userMsg)}}function $(t,o){if(t&1){let e=_();r(0,"section",0)(1,"form",1),w("submit",function(){u(e);let p=s();return f(p.forgetPass())}),c(2,U,2,1,"p",2),r(3,"label",3),a(4," Email"),n(),g(5,"input",4),r(6,"button",5),a(7,"Send"),n()()()}if(t&2){let e=s();i(),C("formGroup",e.forgetForm),i(),m(e.userMsg?2:-1)}}function A(t,o){if(t&1&&(r(0,"p",2),a(1),n()),t&2){let e=s(2);i(),x(e.userMsg)}}function q(t,o){if(t&1){let e=_();r(0,"section",0)(1,"form",6),w("ngSubmit",function(){u(e);let p=s();return f(p.resetTheCode())}),c(2,A,2,1,"p",2),r(3,"label",7),a(4," Reset Code"),n(),g(5,"input",8),r(6,"button",5),a(7,"Send"),n()()()}if(t&2){let e=s();i(),C("formGroup",e.resetCode),i(),m(e.userMsg?2:-1)}}function Z(t,o){if(t&1&&(r(0,"p",2),a(1),n()),t&2){let e=s(2);i(),x(e.userMsg)}}function z(t,o){if(t&1){let e=_();r(0,"section",0)(1,"form",6),w("ngSubmit",function(){u(e);let p=s();return f(p.newPassword())}),c(2,Z,2,1,"p",2),r(3,"label",9),a(4," New Password"),n(),g(5,"input",10),r(6,"button",5),a(7,"Submit"),n()()()}if(t&2){let e=s();i(),C("formGroup",e.newPass),i(),m(e.userMsg?2:-1)}}var k=class t{constructor(o,e){this._ForgotpassService=o;this._Router=e}step1=!0;step2=!1;step3=!1;email="";userMsg="";forgetForm=new b({email:new v("",[d.required,d.email])});resetCode=new b({resetCode:new v("")});newPass=new b({newPassword:new v("",[d.required,d.pattern(/^[A-Z][a-zA-Z0-9_@]{6,}$/)])});forgetPass(){let o=this.forgetForm.value;this.email=o.email,this._ForgotpassService.forgotpassword(o).subscribe({next:e=>{this.step1=!1,this.step2=!0},error:e=>{console.log(e),this.userMsg=e.error.message}})}resetTheCode(){let o=this.resetCode.value;this._ForgotpassService.resetCode(o).subscribe({next:e=>{this.step2=!1,this.step3=!0},error:e=>{this.userMsg=e.error.message}})}newPassword(){let o=this.newPass.value;o.email=this.email,this._ForgotpassService.resetPassword(o).subscribe({next:e=>{e.token&&(localStorage.setItem("etoken",e.token),this._Router.navigate(["/home"]))},error:e=>{this.userMsg=e.error.message}})}static \u0275fac=function(e){return new(e||t)(S(F),S(T))};static \u0275cmp=P({type:t,selectors:[["app-forgetpassword"]],standalone:!0,features:[M],decls:3,vars:3,consts:[[1,"w-50","mx-auto","rounded","bg-main-ligth","p-3","my-4","shadow"],[3,"submit","formGroup"],[1,"alert","alert-danger","w-50","mx-auto","p-2"],["for","email"],["type","email","id"," email","formControlName","email",1,"form-control"],[1,"main-btn","d-block","ms-auto","mt-3"],[3,"ngSubmit","formGroup"],["for","resetCode"],["type","text","id"," resetCode","formControlName","resetCode",1,"form-control"],["for","newpass"],["type","password","id"," newpass","formControlName","newPassword",1,"form-control"]],template:function(e,l){e&1&&c(0,$,8,2,"section",0)(1,q,8,2,"section",0)(2,z,8,2,"section",0),e&2&&(m(l.step1?0:-1),i(),m(l.step2?1:-1),i(),m(l.step3?2:-1))},dependencies:[H,I,V,E,G,j,R]})};export{k as ForgetpasswordComponent};
